data = '''key: ten-million-domains::http:status:code:stats:407, result: 2
key: ten-million-domains::http:status:code:stats:470, result: 4
key: ten-million-domains::http:status:code:stats:404, result: 135055
key: ten-million-domains::http:status:code:stats:200, result: 1087516
key: ten-million-domains::http:status:code:stats:478, result: 2
key: ten-million-domains::http:status:code:stats:447, result: 11
key: ten-million-domains::http:status:code:stats:475, result: 1
key: ten-million-domains::http:status:code:stats:466, result: 1
key: ten-million-domains::http:status:code:stats:587, result: 1
key: ten-million-domains::http:status:code:stats:555, result: 21
key: ten-million-domains::http:status:code:stats:561, result: 1
key: ten-million-domains::http:status:code:stats:495, result: 1
key: ten-million-domains::http:status:code:stats:451, result: 30
key: ten-million-domains::http:status:code:stats:800, result: 1
key: ten-million-domains::http:status:code:stats:418, result: 144
key: ten-million-domains::http:status:code:stats:205, result: 2
key: ten-million-domains::http:status:code:stats:701, result: 108
key: ten-million-domains::http:status:code:stats:440, result: 4
key: ten-million-domains::http:status:code:stats:406, result: 58
key: ten-million-domains::http:status:code:stats:550, result: 4
key: ten-million-domains::http:status:code:stats:473, result: 1
key: ten-million-domains::http:status:code:stats:617, result: 4
key: ten-million-domains::http:status:code:stats:444, result: 360
key: ten-million-domains::http:status:code:stats:304, result: 5
key: ten-million-domains::http:status:code:stats:421, result: 41
key: ten-million-domains::http:status:code:stats:410, result: 3383
key: ten-million-domains::http:status:code:stats:301, result: 4989491
key: ten-million-domains::http:status:code:stats:426, result: 18
key: ten-million-domains::http:status:code:stats:432, result: 33
key: ten-million-domains::http:status:code:stats:442, result: 1
key: ten-million-domains::http:status:code:stats:530, result: 2613
key: ten-million-domains::http:status:code:stats:405, result: 913
key: ten-million-domains::http:status:code:stats:483, result: 1
key: ten-million-domains::http:status:code:stats:428, result: 1
key: ten-million-domains::http:status:code:stats:488, result: 2
key: ten-million-domains::http:status:code:stats:430, result: 1
key: ten-million-domains::http:status:code:stats:519, result: 1
key: ten-million-domains::http:status:code:stats:556, result: 11
key: ten-million-domains::http:status:code:stats:302, result: 659791
key: ten-million-domains::http:status:code:stats:409, result: 7179
key: ten-million-domains::http:status:code:stats:416, result: 4087
key: ten-million-domains::http:status:code:stats:414, result: 2
key: ten-million-domains::http:status:code:stats:509, result: 100
key: ten-million-domains::http:status:code:stats:439, result: 1
key: ten-million-domains::http:status:code:stats:520, result: 924
key: ten-million-domains::http:status:code:stats:456, result: 1
key: ten-million-domains::http:status:code:stats:402, result: 240
key: ten-million-domains::http:status:code:stats:666, result: 3
key: ten-million-domains::http:status:code:stats:420, result: 8
key: ten-million-domains::http:status:code:stats:415, result: 5
key: ten-million-domains::http:status:code:stats:408, result: 7
key: ten-million-domains::http:status:code:stats:481, result: 1
key: ten-million-domains::http:status:code:stats:531, result: 1
key: ten-million-domains::http:status:code:stats:290, result: 1
key: ten-million-domains::http:status:code:stats:437, result: 6
key: ten-million-domains::http:status:code:stats:508, result: 95
key: ten-million-domains::http:status:code:stats:506, result: 8
key: ten-million-domains::http:status:code:stats:604, result: 1
key: ten-million-domains::http:status:code:stats:503, result: 19524
key: ten-million-domains::http:status:code:stats:422, result: 80
key: ten-million-domains::http:status:code:stats:425, result: 13
key: ten-million-domains::http:status:code:stats:443, result: 1
key: ten-million-domains::http:status:code:stats:300, result: 12
key: ten-million-domains::http:status:code:stats:526, result: 16
key: ten-million-domains::http:status:code:stats:204, result: 213
key: ten-million-domains::http:status:code:stats:203, result: 28
key: ten-million-domains::http:status:code:stats:308, result: 112316
key: ten-million-domains::http:status:code:stats:567, result: 20
key: ten-million-domains::http:status:code:stats:0, result: 522221
key: ten-million-domains::http:status:code:stats:523, result: 936
key: ten-million-domains::http:status:code:stats:534, result: 5
key: ten-million-domains::http:status:code:stats:413, result: 1
key: ten-million-domains::http:status:code:stats:471, result: 2
key: ten-million-domains::http:status:code:stats:505, result: 5
key: ten-million-domains::http:status:code:stats:431, result: 1
key: ten-million-domains::http:status:code:stats:511, result: 14
key: ten-million-domains::http:status:code:stats:572, result: 1
key: ten-million-domains::http:status:code:stats:429, result: 9805
key: ten-million-domains::http:status:code:stats:605, result: 1
key: ten-million-domains::http:status:code:stats:1000, result: 1883063
key: ten-million-domains::http:status:code:stats:507, result: 120
key: ten-million-domains::http:status:code:stats:504, result: 338
key: ten-million-domains::http:status:code:stats:403, result: 235358
key: ten-million-domains::http:status:code:stats:307, result: 91756
key: ten-million-domains::http:status:code:stats:493, result: 1
key: ten-million-domains::http:status:code:stats:468, result: 2
key: ten-million-domains::http:status:code:stats:400, result: 25405
key: ten-million-domains::http:status:code:stats:101, result: 15
key: ten-million-domains::http:status:code:stats:900, result: 1
key: ten-million-domains::http:status:code:stats:524, result: 3
key: ten-million-domains::http:status:code:stats:209, result: 1
key: ten-million-domains::http:status:code:stats:570, result: 1
key: ten-million-domains::http:status:code:stats:501, result: 4401
key: ten-million-domains::http:status:code:stats:724, result: 4
key: ten-million-domains::http:status:code:stats:417, result: 7
key: ten-million-domains::http:status:code:stats:500, result: 22016
key: ten-million-domains::http:status:code:stats:510, result: 3
key: ten-million-domains::http:status:code:stats:412, result: 168
key: ten-million-domains::http:status:code:stats:30, result: 1
key: ten-million-domains::http:status:code:stats:423, result: 466
key: ten-million-domains::http:status:code:stats:206, result: 1
key: ten-million-domains::http:status:code:stats:521, result: 154703
key: ten-million-domains::http:status:code:stats:512, result: 8
key: ten-million-domains::http:status:code:stats:303, result: 10508
key: ten-million-domains::http:status:code:stats:535, result: 2
key: ten-million-domains::http:status:code:stats:599, result: 3
key: ten-million-domains::http:status:code:stats:452, result: 1
key: ten-million-domains::http:status:code:stats:434, result: 2
key: ten-million-domains::http:status:code:stats:522, result: 48
key: ten-million-domains::http:status:code:stats:600, result: 3
key: ten-million-domains::http:status:code:stats:419, result: 1
key: ten-million-domains::http:status:code:stats:401, result: 2251
key: ten-million-domains::http:status:code:stats:514, result: 13
key: ten-million-domains::http:status:code:stats:201, result: 9
key: ten-million-domains::http:status:code:stats:207, result: 1
key: ten-million-domains::http:status:code:stats:477, result: 50
key: ten-million-domains::http:status:code:stats:448, result: 2
key: ten-million-domains::http:status:code:stats:453, result: 18
key: ten-million-domains::http:status:code:stats:202, result: 330
key: ten-million-domains::http:status:code:stats:310, result: 1
key: ten-million-domains::http:status:code:stats:80, result: 1
key: ten-million-domains::http:status:code:stats:247, result: 4
key: ten-million-domains::http:status:code:stats:502, result: 11387'''
import pandas as pd

# Load the data into a list of dictionaries
data_list = []
for row in data.split("\n"):
    status_code = row.split(", result:")[0].split(":")[-1]
    count = int(row.split(", result:")[1])
    data_list.append({"status_code": int(status_code), "count": count})

# Create a DataFrame
df = pd.DataFrame(data_list)

# Compute the rate given a total number of 10 million
total_count = 10_000_000
df["rate"] = (df["count"] / total_count).round(2)


accessible_condition = (
    (df["status_code"] != 1000) &
    (df["status_code"] != 0) &
    (df["status_code"] != 404) &
    ~df["status_code"].between(500, 599)
)

# Inaccessible domains: status code 1000, 0, 404, and 500-599 range
inaccessible_condition = ~accessible_condition

# Sort by rate
df = df.sort_values(by="rate", ascending=False)

# Sum the count column
total_sum = df["count"].sum()
print(f"Total count: {total_sum}")
print(df)

# Calculate the total number of accessible and inaccessible domains
accessible_domains = df.loc[accessible_condition, "count"].sum()
inaccessible_domains = df.loc[inaccessible_condition, "count"].sum()

print( accessible_domains, inaccessible_domains ,(inaccessible_domains/ total_count).round(3))